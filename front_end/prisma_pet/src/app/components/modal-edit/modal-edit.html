<div class="modal-backdrop">
  <div class="modal-content">
    <h2 tabindex="-1" #modalTitle class="form-section__title">Editar Dados</h2>
    <form aria-label="Formulário de dados pessoais">
      <div class="form-grid">
        <!-- Nome -->
        <div class="form-group">
          <label for="nome" class="form-label form-label--required">Nome Completo</label>
          <input
            type="text"
            id="nome"
            name="nome"
            class="form-input"
            [(ngModel)]="editedUser.name"
            required
            aria-required="true"
            autocomplete="name"
            placeholder="Digite seu nome..."
          />
        </div>

        <!-- CPF -->
        <div class="form-group">
          <label for="cpf" [class]="class_is_required">CPF</label>
          <input
            type="text"
            id="cpf"
            name="cpf"
            class="form-input"
            [(ngModel)]="editedUser.cpf"
            (input)="applyCpfMask($event)"
            maxlength="14"
            aria-required="true"
            required="{{ editedUser.type !== 'admin' ? true : false }}"
            pattern="\d{3}\.\d{3}\.\d{3}-\d{2}"
            title="Formato: 000.000.000-00"
            placeholder="Digite seu CPF..."
          />
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email" class="form-label form-label--required">E-mail</label>
          <input
            type="email"
            id="email"
            name="email"
            class="form-input"
            [(ngModel)]="editedUser.email"
            aria-required="true"
            autocomplete="email"
            placeholder="email@exemplo.com"
          />
        </div>

        <!-- Senha -->
        <div class="form-group">
          <label for="senha" class="form-label">Senha</label>
          <input
            type="password"
            id="senha"
            name="senha"
            class="form-input"
            [(ngModel)]="editedUser.password"
            autocomplete="current-password"
            aria-describedby="senha-hint"
            placeholder="********"
          />
          <small
            id="senha-hint"
            style="color: var(--text-secondary); margin-top: 0.25rem; font-size: 0.875rem"
            >Deixe em branco para manter a senha atual</small
          >
        </div>

        <!-- Telefone -->
        <div class="form-group">
          <label for="telefone" class="form-label">Telefone</label>
          <input
            type="tel"
            id="telefone"
            name="telefone"
            class="form-input"
            [(ngModel)]="editedUser.phone"
            (input)="applyTelephoneMask($event)"
            maxlength="15"
            autocomplete="tel"
            pattern="\(\d{2}\) \d{5}-\d{4}"
            title="Formato: (00) 00000-0000"
            placeholder="Digite seu telefone..."
            maxlength="15"
          />
        </div>

        <!-- Pix -->
        @if (editedUser.type === 'vet') {
        <div class="form-group">
          <label for="numero" [class]="class_is_required">Pix</label>
          <input
            type="text"
            id="numero"
            name="numero"
            class="form-input"
            [(ngModel)]="editedUser.pix"
            required="{{ editedUser.type === 'vet' ? true : false }}"
            placeholder="Digite seu Pix..."
          />
        </div>
        } @if (editedUser.type === 'vet') {
        <!-- CRMV -->
        <div class="form-group">
          <label for="crmv" [class]="class_is_required">CRMV</label>
          <input
            type="text"
            id="crmv"
            name="crmv"
            class="form-input"
            [(ngModel)]="editedUser.crmv"
            required="{{ editedUser.type === 'vet' ? true : false }}"
            placeholder="Digite seu CRMV..."
          />
        </div>
        }

        <!-- ESPECIALIDADE  -->
        @if (editedUser.type === 'vet') {
        <div class="form-group" *ngIf="editedUser.type === 'vet'">
          <label for="especialidade_vet" class="form-label">Especialidade</label>
          <select
            id="especialidade_vet"
            name="especialidade_vet"
            class="form-input"
            [(ngModel)]="editedUser.especialidade_vet"
          >
            <option value="">Selecione a especialidade...</option>
            <option *ngFor="let especialidade of especialidadesVet" [value]="especialidade">
              {{ especialidade }}
            </option>
          </select>
        </div>
        }

        <!-- CEP -->
        <div [class]="class_group_full_option">
          <label for="cep" class="form-label">CEP</label>
          <input
            type="text"
            id="cep"
            name="cep"
            class="form-input"
            [(ngModel)]="editedUser.cep"
            autocomplete="postal-code"
            (focusout)="findCEP(editedUser.cep)"
            pattern="\d{5}-\d{3}"
            (input)="applyMaskcCEP($event)"
            title="Formato: 00000-000"
            placeholder="Digite seu CEP..."
            maxlength="9"
          />
        </div>

        <!-- Endereço -->
        <div class="form-group">
          <label for="endereco" class="form-label">Endereço</label>
          <input
            type="text"
            id="endereco"
            name="endereco"
            class="form-input"
            [(ngModel)]="editedUser.endereco"
            autocomplete="street-address"
            placeholder="Rua, Avenida, etc."
          />
        </div>

        <!-- Bairro -->
        <div class="form-group">
          <label for="bairro" class="form-label">Bairro</label>
          <input
            type="text"
            id="bairro"
            name="bairro"
            class="form-input"
            [(ngModel)]="editedUser.bairro"
            placeholder="Bairro"
          />
        </div>

        <!-- Cidade -->
        <div class="form-group">
          <label for="cidade" class="form-label">Cidade</label>
          <input
            type="text"
            id="cidade"
            name="cidade"
            class="form-input"
            [(ngModel)]="editedUser.cidade"
            autocomplete="address-level2"
            placeholder="Digite sua cidade..."
          />
        </div>

        <!-- Complemento -->
        <div class="form-group">
          <label for="complemento" class="form-label">Complemento</label>
          <input
            type="text"
            id="complemento"
            name="complemento"
            class="form-input"
            [(ngModel)]="editedUser.complemento"
            placeholder="Apto, bloco, etc."
          />
        </div>
      </div>

      <!-- Buttons -->
      <div class="button-group">
        <button type="button" class="btn btn--secondary" (click)="onCancel()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
          Cancelar
        </button>
        <button type="submit" class="btn btn--primary" (click)="onSave()">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Salvar Alterações
        </button>
      </div>
    </form>
  </div>
  <app-loading *ngIf="loading"></app-loading>
</div>
